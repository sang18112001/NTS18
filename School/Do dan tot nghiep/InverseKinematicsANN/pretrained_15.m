function [Y,Xf,Af] = pretrained_15(X,~,~)
%PRETRAINED_15 neural network simulation function.
%
% Auto-generated by MATLAB, 28-Nov-2023 17:39:59.
% 
% [Y] = pretrained_15(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 3xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0.050015307656058;0;-0.00286161180087569];
x1_step1.gain = [9.52646325174905;13.3344725140591;7.91013723419455];
x1_step1.ymin = -1;

% Layer 1
b1 = [-5.478577288008858126;4.9419811641705280181;-3.4233018450082659534;-4.4586326457440650373;-4.8368732883521525778;-4.0348005571790306334;4.3325843518484905559;-4.1580994529254340364;4.1480465347466441983;4.5990947548076404061;-2.2714569738442840219;2.7150535453057242918;2.1988677801194613792;-1.2771548317653491633;-2.2840394220654181012;-2.5629318248949655157;-2.4270247963302953309;1.4996582910586664372;-1.3831468416502790131;0.72140124059146548685;-0.92850308499570877174;0.80964569403317665497;-1.1156256887347191231;0.91055068747549494645;-2.3157979641457928643;-0.39091716610380783381;0.558230294846614572;0.39123772658930910939;-1.7954995574506029676;1.0040159061524209783;0.95080575449711290936;1.6369305484047815824;-1.5238355173435591539;-0.78017859113464560483;1.8235892656659724587;1.904311407297693215;1.926915055156990686;2.4239224779039085789;2.9359239522189675142;-3.3136690853226040687;-3.1788380578724999559;3.4914724839081485719;3.4057047040875882971;3.1490820363997915621;-4.1386277566729887667;2.5303319535673076679;4.5457307663306174561;3.8564744212228583287;-4.983569799663228217;-5.4023097739142214024];
IW1_1 = [0.77042082458748739615 -1.8748015091751180083 3.7648271135057207459;-2.112322385477290787 -3.1507368914299207496 -3.4952276504414934166;1.9728821267499676573 0.04622791499220745004 -3.0213254642558715624;0.26355778604574059409 -3.782146189795276392 -2.1389745669605582101;1.4659782336350599685 -3.8066551622568094437 -2.4613600287616845819;2.7761049154601167288 -2.6420119651854956366 1.9705695862715908451;-2.3253641416326220615 2.5612272599522483141 3.8948838909202598835;0.37598100016601859741 4.0955331014824132296 2.3229146680613119713;-3.0578873742741534691 1.2281384823927401495 -0.75679874410851954991;-4.8949235589835717875 -3.762997934878058448 2.1899150472226205366;2.0034343716165046168 -2.2648357252683992691 -3.922770006948550936;-2.2812455854497204477 -3.6747581340156432184 2.6162939979756534292;-3.4003511734924223298 2.7150311086397636018 1.7227029113598946175;1.8358508611268580246 -2.2930248010404210568 -2.8814413800098419571;1.6652352450366896264 4.004302111640954287 0.082828624822644705827;1.3823804030043436164 -4.7651605011419126967 1.3769453765197996464;3.6602051440101530666 0.69781491225192004979 0.58601933230374270156;-0.82929571770587029444 0.18121538615333490641 2.6912448631404530808;1.7421701861280189938 4.2537658338474910735 1.1243884364800893483;-0.72263763124767244062 4.2931184105967448161 0.80642592292422587974;1.2367457991303933973 -1.4562988220411998697 3.0379011218996407884;-1.1300823642902984023 3.3165927311235900987 -1.9492501797239774053;1.2387546157752657994 -3.6581456876899314246 1.720091934626944763;-1.2662152548707279465 -3.7169990873462510628 -3.0841263666962990264;4.8775489816121657682 3.7465769559054296067 0.13606028342325127145;-1.2585949323459992844 3.0205163872202183128 2.4252144590855611028;1.9871064945596241813 0.56914154472211653246 -4.0030503315295016264;1.6493336563500493597 -3.6237526284342056471 -0.032577925534084464787;-1.6714020355010517083 3.2945276709373634283 -1.4945188257488251082;2.2344661834660959343 3.6010056225193358692 1.1839945834883840448;3.0275602926269788995 1.3572645559201081955 2.1688380896539602993;1.9290180906371117153 -0.6782586492431351699 -3.6777294115926646434;-0.8597230248415983489 -2.8832552093469971943 2.7484691334667505913;-2.5655838202359708689 -0.46888301365766388296 2.5396511420442093865;2.3563081658388531636 2.5884224552971266675 -3.166219433471060718;3.0258933788263018272 0.49864885200004710475 -2.47397157961023062;0.57243920579361418088 0.075804759579377378742 3.8387404775276436908;3.6118554485535776521 3.175961664038272847 -0.75050715353255303963;1.6188562807652948639 -4.1636949461624386259 2.462295649291581956;-1.798951795101436657 -2.2410401779580513271 3.1124821014581884882;-2.5779932891955539276 -2.8456457243869359708 2.3984484532736680684;0.1701184999851008961 -1.8106197965684769358 4.0707339583921839932;2.1271938437888615603 -2.6904205215599601431 -2.8603923053909063867;1.2604592794691789059 2.787786407018802759 0.96872463034250966274;-2.6296115125463290774 -2.8828575877673627836 2.5300717186864449815;0.94133455732508453107 3.2575558069718604237 2.0791307798984135502;1.8588537075602700188 -2.2649029171388410653 3.1029329824439755292;2.5059993375554001638 0.62701269345728527504 -2.4582972410700425492;-1.6378442813942029055 -1.5014324261797573623 4.0931044610611984069;-4.0886294986467586199 1.1817329006102141875 1.051514410720647108];

% Layer 2
b2 = [-0.06366723598534339279;0.64010672240736499194;0.76677822461817701782];
LW2_1 = [-0.020495032621367214459 0.36759371469463675286 -0.0075490511480588474991 0.087997222346484868516 -0.029869780406897569747 0.011446989984158993311 -0.013413747513612994319 0.71179884284432426433 -0.092737885415578508175 -0.049187994543048799145 0.25748797107633492054 -0.04065472845253816081 0.015945771815536011196 -0.1075608820190098458 -0.022937229449123706926 0.017683784590076898069 -0.035256524942974383496 1.2742165508486760217 0.033975136592816528036 -0.043123319216770206186 -0.012463229940684071584 0.26262473521118029351 0.27743683552388476166 -0.031438266118508091662 -0.056102147024390182362 0.034123719801350795022 -0.24172188525195667519 -0.37268892113186691262 -0.25472808810174768501 -0.033962364307915132722 0.0038881643494129512068 -0.0047161619385624950485 -1.1724514365314209208 0.25507571119314892405 0.0034576664867143904435 -0.051446243576474599835 -0.011252227857233365951 -0.0019709386512628151479 0.10715855470111866621 -0.052975981167792632331 -0.26557568227632760705 -0.54567576173149401342 0.1035925305160954879 0.044512564025503201237 -0.083659487735275234188 -0.037800557660960146245 -0.22680327096026725586 -0.0015577324889675424942 0.0024206427178737849153 -0.094986185046116944353;-0.038135687440452675778 -0.29561645852640344723 -0.08820851847116265021 -0.40929575273844603922 -0.18924308099852091281 -0.054407461427048414704 -0.046316960058649547793 0.45609275921881431426 -0.82655957491302955997 -1.2908683382536416673 0.19282926140723194441 -0.88091558568431060916 0.018551386136480593758 -0.70595200059490170741 -0.17379684953961901939 -1.4752497373319088947 -0.31930670869910060539 -0.022445566073333873824 0.13178543660503416746 0.051695015196241922428 -0.0023326198803305109308 -1.3491458828735505282 0.69402470374169400458 0.074858037615773739826 -1.3025050111483358339 0.014438282156258606947 -0.23933104512604283509 -0.77762072689330608011 -0.56438515763307872675 -0.95231360436538659009 -0.020693201946247651024 -0.064926909796803100594 -0.12654013398629460063 -0.41570962202664318852 0.054350978148755085817 -0.39205998992260959746 0.057131540551460406607 0.0017950637591135809763 0.25663455870411727711 -0.22231648919313715118 0.3498096304275542523 -0.1679359864233601618 -0.39068558732264224709 -0.25403069063531374949 -0.74870418919477088604 -0.042465688549123803419 0.50514480674037864905 -0.052558086653539164146 0.02788116610291796818 0.10635471509533786505;0.074202022168940423574 0.57289587631654248501 0.22245487804086150341 -0.068150310903037400467 0.31863580746731456905 0.084212284541975324093 0.0791532089416821516 -0.038441733559891798355 1.5974049084348225236 2.3790373060082128376 0.25974964320217786007 1.6964005122583192264 0.0011077223407496400963 0.33523203971066689588 0.20292947542711634035 0.81119617004981081632 0.60161775494918467988 -0.4279254203200718587 -0.13562355446300056183 -0.076016124232772555591 0.015118074555539108214 -0.036607009895760045382 -0.85875290726723629842 -0.13930228196761193504 2.3906591953509641613 0.020836851330916936198 -0.21648559235906916776 0.099556997578478231836 -0.047581956962601881789 1.8164035277510706123 0.033909953190852180904 -0.011457584872445907009 0.34015498430872176394 0.15988039172197782145 -0.053095441432455967035 0.046669887598312677357 -0.00072641057801918387359 -0.008214529221947456869 -0.12508870012544132111 0.21763576681884472253 -0.12757136376167785285 0.066703620221782056188 -0.7340585116674699373 0.32881697630397438425 0.11685255430862095949 0.067109539987230418245 -0.61842722570262109727 -0.035544388422102890512 0.012553274176756969854 0.57279929468669565917];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [1.74403571741344;0.844430415084228;0.800698620563121];
y1_step1.xoffset = [0;-0.0867378970815097;-2.74702687782755];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end

function [Y,Xf,Af] = pretrained_10_test(X,~,~)
%PRETRAINED_10_TEST neural network simulation function.
%
% Auto-generated by MATLAB, 11-Dec-2023 08:54:53.
% 
% [Y] = pretrained_10_test(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 3xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0.050015307656058;0;-6.28996925726433e-06];
x1_step1.gain = [9.52646325174905;13.3344725140591;8.00048668041704];
x1_step1.ymin = -1;

% Layer 1
b1 = [-5.15636647840597373;6.9738792347372609015;6.0921668374968298565;-4.5642727685192037157;-3.8329557614387104181;-3.8157640604239775328;4.0490592274054435507;-3.4391685362991961661;-3.1386878401259967752;-3.2031586585955933444;3.4811267712409201813;2.6521884919558185167;2.9694844373585609354;-3.1163299309177170393;-2.3767626163521717864;1.0033697677336401721;-2.9709199338722580563;-1.7866274593883366695;-1.4555303826350896035;1.2392156794665676323;1.7477750283584885249;-0.71380907493538792163;-0.9502635487760531241;-0.16671160303871493391;0.27585406229476128193;0.25523821407811858597;-0.57001342328932502745;0.51662851556533562203;1.3282621502141844783;-0.37123790021295893782;-1.3679191608269289926;-0.21962796570185480483;1.1378898724749444415;1.3421451361956369119;1.3179043807347228245;-2.470220393944955628;2.7551919868353489385;2.2081399965938630636;-2.8439616650636905248;-1.9982053326970357077;3.3181613073274567327;3.6979479903521323969;3.4669600240672355795;-3.1926393365088889809;-3.3766873295391470755;-4.7456154137928061587;4.7616584971013269367;-4.5335452726446465732;-4.3990670802410605233;-4.8923858232229679999];
IW1_1 = [3.8490970661876193759 3.1785280106817141998 1.3095841574079110092;-7.543059195038492426 -2.0586269332462414638 -1.0223163144589957341;-4.3044188379770096375 -0.95822252341861258174 -1.9199159441192967801;0.53808863503272363893 4.4266828947525214133 1.0259169387936577511;1.4543150319742219612 2.1336184105807163292 4.792441373441018726;-0.49944045690682548067 2.1962350283836964415 -4.6715072368536203484;-4.0022529815888390203 -2.6274855445616207561 1.1384712862349262164;2.2006529867223694197 0.33791464095248180399 3.4721854010038479821;2.089616086798599337 2.5216237353144377309 -2.5023679317276181777;3.2699319689552477364 1.0458554476193857585 -2.0204306369736966253;-1.7857435168173172446 2.7887487813017748373 -0.15201174282096147072;-0.14267151475018685636 3.2309611914535962818 1.6580793162130464946;-1.406606097621132978 3.8509501485882311478 0.4020901354902687852;0.13929634875786958692 -3.6462126582979497158 -1.9405179564341028531;0.69515088622803278273 -4.7764414568462036925 0.36319423989831695065;-3.4465796047349601672 -1.5438665412637089247 1.3258466035161833307;1.7762025438408064471 -4.7731423677097692959 -0.7832433461094761018;1.5493014306353911635 -0.19844285366806757587 -3.6117783555590650124;2.4730111780641008679 3.8063269801547541249 1.8518343990380852215;-2.0083505696027126319 -4.2676749413004415601 0.030725080684961096622;-3.4214678876627080406 -1.4338778410080912362 -0.18418487934660718319;0.47817519100824884548 -0.70763218106930581008 -2.7100055124622741687;3.3037611867571987645 3.1885344018323289461 -1.8342248566663457154;-2.4330433922603509345 3.5705865392042364093 -2.8397400823388463387;-3.3183234323337278404 -0.96057642016507205351 -1.1202803809195898133;3.5274691034434955128 -1.3138549848533671582 2.5723743992309913153;-0.31416967047081523212 3.7248547064263561879 -1.2832096727524615609;1.5599547304893524036 2.11096246524653397 -3.6230463679437243663;2.5009873339610879661 2.7802284195458990546 -0.1304658170625387914;-1.525864800017019185 2.2018048268259828859 2.1885675430121449558;-2.1505948504912879571 0.33577579477560065557 -3.6057759529018231781;-2.1324951506502762832 1.4271395839898266544 2.487028997574270317;2.1638532678937276721 -0.68949198264709266049 -3.2055635662869681468;2.2696003830807938151 4.0443081707419645809 -2.8515986618778135231;0.050459596449253893424 -1.14141053748371335 -2.3735170523910826823;-3.6179513696938361278 1.2433159091535392893 2.1320070711017677922;1.7618570615542443747 3.4512541333618642625 -0.82669148307415518673;0.35418215199920394243 1.1322808963758979051 3.5355381474256750707;-1.0550223696042497767 -0.70465785631599542338 -3.6576129164150050777;-3.3299242346797917058 -3.2403992041934319701 -1.1301423661212683935;2.299753016568895525 -2.8663044993716333408 2.9371499725075844722;0.55867995151391014463 -3.6419989648832986617 -3.5577688471574777651;4.0252892090043701501 -1.4591710927424912381 0.97023329329342289373;-1.6725931904303068531 -2.7749415671616395329 0.80472790758032197722;-0.4924418576387181723 -2.4289045323308569024 3.0797663430490995751;-2.4104196873837517856 3.5432165105160482454 2.3193316375921746442;3.9584865776646953606 -0.18989323669762780966 3.0763622428094752337;-3.5960876364279843465 0.28701910338746933204 -2.9464511562466535466;-1.4688678831066670494 1.8026859035458526748 -3.0283320667271111937;-2.6523173063702953911 -3.5535948193294522035 0.63842875289058087507];

% Layer 2
b2 = [0.066870148835471265869;0.053995324080278454815;1.5838451317062895995];
LW2_1 = [-0.68547162552092688603 0.083011123305745754264 -0.43326026797946370905 0.34863197439147214363 -0.19489890564170020415 -0.14556437105290284673 -0.32431119931153251645 0.022959101520657859696 -0.0052813885524841189256 -0.29951613773865487511 0.032982207773629895753 0.22883172747641661315 0.20818879456950112328 0.24864527200573632859 -0.2704802310243361041 -0.01291853884472532292 0.16047856376691543856 -0.66955563195047040903 -0.10867373894826748426 -0.018824459376059612253 0.022302145492854891229 -0.034664766881584395397 0.3114797401234200569 0.0097322052615932425762 -0.33177393356525480828 -0.00022775889676201604159 0.18284232293239696676 0.65758393820636396043 -0.0062053497764302618586 0.027643561444326711363 4.2321188135370275843e-05 0.0013559460050005401471 0.0017913519182131229946 -0.0077057008000416217161 0.015161839372175821283 0.0088162918832569939914 0.043132338741091652556 -0.0036037510746267016094 -0.0010028693933305725221 0.32683135773118149325 -0.11897370994451893222 0.14591033065353606335 -0.023258584425788660088 -0.083760505371022378474 0.037858807821848965147 0.46809600886106161877 0.0098653414417565199468 -0.004642520439323168796 0.25743785348481462716 -0.027912978795233051033;1.0483446003036052119 1.5755549341445653777 -0.089291896166088013942 -0.24230607705264153862 1.2117835110257673126 -0.30093067150995256309 0.18625810120062027964 -0.19160155449368218572 -0.10569317222278545865 -0.060767907175774786566 -0.071161909061925585074 0.27733509223782526476 -1.0411415926525831033 0.63157988009519905326 -0.78978963689715497853 0.048555099692481479279 -1.0454418885317549037 0.22767935977244993517 -0.0085384321500639823871 -0.02374257579447944938 0.11439121040414783337 -0.17069644281710893985 -0.094874603201399759778 -0.30249329050341355885 0.047568928963940097787 0.007250181570441662296 0.30283778687437862276 -0.23727696612695128864 -0.022757810685627953562 -0.033083827959894014648 0.011772038977359022133 0.13447601769532877003 0.06074668890929726256 -0.02434694003380455038 0.3315622383471990009 -0.028235592197545959087 -0.26801122623711809423 0.049265604953549479994 -0.095339277455615836776 -0.03700150029704134258 -0.058139182541254504077 0.36921887533520419966 -0.1083087268449434426 0.55841421044341710278 0.13145794863421791931 0.34424867857957086592 -0.67380644134351574959 -0.89902079297437842431 0.047690999766726790976 0.12028109909325365723;-0.3382498608700126308 -2.7274713371151437791 0.83312191871741070326 0.17703935939484546913 -0.48720716318601864359 0.38046885904846405868 0.010910825415919742087 0.20000477225014101634 0.067483944196743722577 0.2350887515391384408 -0.070356686449543404116 0.59791854749069783814 -0.11054790338204716071 0.21530076670503178748 0.26649528962173013591 -0.054009496192415913651 0.23338308079941214035 0.16800544670309949802 0.00011350119361291683296 0.0038201539482475427301 -0.25852521878278200695 -0.049339054359009773543 -0.070724214623506351241 0.076210105120575466486 0.095876592561150095206 -0.0011443591199313438937 -0.33182549594847454699 -0.17832033040074643515 0.05129987092548444344 0.085546232971780031273 0.0013686440197375054906 -0.041168579689343044736 -0.041379747957883177001 0.00072381116865780689013 -0.29416692246390740983 0.023522114048626783372 0.26298202979843110505 0.011699057851994007148 0.00053470803827219384914 -0.098232621766148317533 0.088208420071376761329 0.85293969337954267385 0.029933001931015158076 -0.21891468193083163385 0.0076512741918628186105 0.49688549057355030358 0.061216991010077922986 0.057064029342323165095 0.014319469607050985469 0.01213505879913019149];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [1.74403571741344;0.964569502683839;0.800698620563121];
y1_step1.xoffset = [0;0.208258648908721;-2.74702687782755];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
